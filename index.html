<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Life RPG Pixel Edition</title>

<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

<style>
:root {
    --bg:#1a1a2e;
    --card:#242442;
    --blue:#4d9be6;
    --green:#48cd48;
    --red:#e64d4d;
    --border:#4d4d80;
    --text:#fff;
}

* { box-sizing: border-box; }

body {
    margin:0;
    font-family:'Press Start 2P', cursive;
    background:var(--bg);
    background-image:
        linear-gradient(rgba(255,255,255,.05) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255,255,255,.05) 1px, transparent 1px);
    background-size:20px 20px;
    color:var(--text);
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
}

.container {
    width:90%;
    max-width:420px;
    background:var(--card);
    padding:20px;
    border:4px solid var(--border);
    box-shadow:8px 8px 0 rgba(0,0,0,.5);
    max-height:90vh;
    overflow-y:auto;
}

.hidden { display:none; }

.main-title {
    text-align:center;
    font-size:16px;
    margin-bottom:20px;
}

.section-title {
    font-size:10px;
    margin:25px 0 15px;
    color:#ffd700;
}

input {
    width:100%;
    padding:12px;
    margin-bottom:6px;
    background:#000;
    color:var(--green);
    border:4px solid var(--border);
    font-family:'Press Start 2P';
    font-size:9px;
}

button {
    width:100%;
    padding:12px;
    font-family:'Press Start 2P';
    font-size:9px;
    cursor:pointer;
    border:4px solid #000;
    margin-bottom:5px;
}

.btn-green { background:var(--green); color:#fff; }
.btn-blue { background:var(--blue); color:#fff; }
.btn-red { background:var(--red); color:#fff; }

.slot-item {
    background:rgba(0,0,0,.3);
    padding:12px;
    margin-bottom:8px;
    border:2px solid var(--border);
    display:flex;
    justify-content:space-between;
    align-items:center;
}

.slot-info { font-size:8px; line-height:1.6; }

.todo-item {
    display:flex;
    gap:10px;
    padding:10px;
    border:2px solid var(--border);
    margin-bottom:6px;
    background:rgba(0,0,0,.3);
}

.checkbox {
    width:20px;
    height:20px;
    border:3px solid var(--blue);
    cursor:pointer;
}

.checkbox.done { background:var(--green); }

.todo-text {
    flex:1;
    font-size:10px;
}

.todo-text.done { text-decoration:line-through; color:#555; }

.timer-box {
    text-align:center;
    margin-top:10px;
}

#timer-display {
    font-size:18px;
    margin:15px 0;
    color:var(--green);
}
</style>
</head>

<body>

<div id="login-screen" class="container">
    <div class="main-title">LIFE RPG</div>

    <h1 class="section-title">[ ZADANIA ]</h1>
    <div id="slots"></div>
    <input id="new-game" placeholder="ZADANIE...">
    <button class="btn-green" onclick="addGame()">+ DODAJ</button>

    <h1 class="section-title">[ TO-DO ]</h1>
    <div id="todo"></div>
    <input id="todo-input" placeholder="WPISZ...">
    <button class="btn-blue" onclick="addTodo()">+</button>

    <h1 class="section-title">[ TIMER ]</h1>

    <input id="focus-input" type="number" placeholder="FOCUS (min)">
    <input id="break-input" type="number" placeholder="BREAK (min)">
    <button class="btn-green" onclick="startPomodoro()">POMODORO</button>

    <hr style="margin:15px 0; border:1px solid var(--border);">

    <input id="timer-input" type="number" placeholder="TIMER (min)">
    <button class="btn-blue" onclick="startTimer()">TIMER</button>

    <div class="timer-box">
        <div id="timer-display">00:00</div>
        <div id="timer-mode" style="font-size:8px;color:#ffd700;">TRYB: ---</div>
        <button class="btn-blue" onclick="pauseTimer()">PAUZA</button>
        <button class="btn-red" onclick="resetTimer()">RESET</button>
    </div>
</div>

<script>
let games = JSON.parse(localStorage.getItem("games")) || {};
let todos = JSON.parse(localStorage.getItem("todos")) || [];

let timerTime = 0;
let timerInterval = null;
let timerMode = "NONE";
let breakTime = 0;

function save() {
    localStorage.setItem("games", JSON.stringify(games));
    localStorage.setItem("todos", JSON.stringify(todos));
}

function renderGames() {
    const el = document.getElementById("slots");
    el.innerHTML = "";
    for (let g in games) {
        el.innerHTML += `
        <div class="slot-item">
            <div class="slot-info">${g}<br>XP: ${games[g]}</div>
            <button class="btn-blue" onclick="games['${g}']+=20;save();renderGames()">+20XP</button>
        </div>`;
    }
}

function addGame() {
    const val = document.getElementById("new-game").value.trim();
    if(val && !games[val]) {
        games[val]=0;
        save(); renderGames();
        document.getElementById("new-game").value="";
    }
}

function renderTodo() {
    const el = document.getElementById("todo");
    el.innerHTML="";
    todos.forEach((t,i)=>{
        el.innerHTML+=`
        <div class="todo-item">
            <div class="checkbox ${t.done?'done':''}" onclick="toggleTodo(${i})"></div>
            <div class="todo-text ${t.done?'done':''}">${t.text}</div>
        </div>`;
    });
}

function addTodo() {
    const val = document.getElementById("todo-input").value.trim();
    if(val) {
        todos.push({text:val,done:false});
        save(); renderTodo();
        document.getElementById("todo-input").value="";
    }
}

function toggleTodo(i){
    todos[i].done=!todos[i].done;
    save(); renderTodo();
}

function updateTimerUI() {
    const m = String(Math.floor(timerTime/60)).padStart(2,'0');
    const s = String(timerTime%60).padStart(2,'0');
    document.getElementById("timer-display").innerText = `${m}:${s}`;
    document.getElementById("timer-mode").innerText = `TRYB: ${timerMode}`;
}

function runTimer() {
    updateTimerUI();
    timerInterval = setInterval(()=>{
        timerTime--;
        updateTimerUI();
        if(timerTime<=0){
            clearInterval(timerInterval);
            timerInterval=null;

            if(timerMode==="FOCUS"){
                alert("KONIEC FOCUSU +20 XP");
                Object.keys(games)[0] && (games[Object.keys(games)[0]]+=20);
                save(); renderGames();
                timerMode="BREAK";
                timerTime=breakTime;
                runTimer();
            } else {
                alert("KONIEC");
                timerMode="NONE";
                updateTimerUI();
            }
        }
    },1000);
}

function startPomodoro(){
    pauseTimer();
    const f = +focus-input.value;
    const b = +break-input.value;
    if(!f||!b) return alert("USTAW CZASY");
    timerMode="FOCUS";
    timerTime=f*60;
    breakTime=b*60;
    runTimer();
}

function startTimer(){
    pauseTimer();
    const t = +timer-input.value;
    if(!t) return alert("USTAW TIMER");
    timerMode="TIMER";
    timerTime=t*60;
    runTimer();
}

function pauseTimer(){ clearInterval(timerInterval); timerInterval=null; }
function resetTimer(){ pauseTimer(); timerTime=0; timerMode="NONE"; updateTimerUI(); }

renderGames();
renderTodo();
updateTimerUI();
</script>

</body>
</html>